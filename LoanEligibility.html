<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Loan Eligibility - FiClear</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" crossorigin="" href="/assets/index-C7ZxKpI8.css">
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-white min-h-screen">
    <div id="root">
      <div id="site-header"></div>

    <!-- HERO SECTION -->
    <div class="bg-gradient-to-br from-indigo-100 via-purple-50 to-blue-50 py-16">
      <div class="max-w-5xl mx-auto px-4 text-center">
        <!-- Badge -->
        <div class="inline-flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-full mb-6 text-sm font-medium">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
          </svg>
          Quick & Hassle-free
        </div>

        <!-- Main Heading -->
        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-2">
          Check Your Loan
        </h1>
        <h2 class="text-4xl md:text-5xl font-bold text-blue-600 mb-4">
          Eligibility
        </h2>

        <!-- Subtitle -->
        <p class="text-gray-600 text-lg max-w-2xl mx-auto">
          Complete our simple form and get instant eligibility results across 50+ banks with personalized loan offers.
        </p>
      </div>
    </div>

    <main class="max-w-5xl mx-auto px-4 py-12">
          <div class="mb-8">
            <h1 class="text-2xl font-bold text-gray-900 mb-2">Eligibility Checker</h1>
            <p class="text-gray-600 mb-6">Complete the form to check loan eligibility across multiple banks</p>

            <!-- Progress bar with connecting lines -->
            <div class="mb-8">
              <div class="relative w-full h-2 bg-gray-200 rounded-full overflow-hidden">
                <div id="progress-fill" class="absolute left-0 top-0 h-full bg-blue-600 transition-all" style="width:25%"></div>
              </div>
            </div>

            <!-- Step indicators with better styling -->
            <div id="steps-indicators" class="flex justify-between items-start gap-4 mb-8">
              <div class="flex flex-col items-center gap-2 flex-1">
                <div class="indicator w-10 h-10 rounded-full flex items-center justify-center bg-blue-600 text-white font-semibold" data-step="1">1</div>
                <div class="text-center">
                  <p class="text-sm font-semibold text-gray-900">Personal Info</p>
                  <p class="text-xs text-gray-500">Your details</p>
                </div>
              </div>
              <div class="flex flex-col items-center gap-2 flex-1">
                <div class="indicator w-10 h-10 rounded-full flex items-center justify-center bg-gray-200 text-gray-500 font-semibold" data-step="2">2</div>
                <div class="text-center">
                  <p class="text-sm font-semibold text-gray-900">Income</p>
                  <p class="text-xs text-gray-500">Financial details</p>
                </div>
              </div>
              <div class="flex flex-col items-center gap-2 flex-1">
                <div class="indicator w-10 h-10 rounded-full flex items-center justify-center bg-gray-200 text-gray-500 font-semibold" data-step="3">3</div>
                <div class="text-center">
                  <p class="text-sm font-semibold text-gray-900">Credit</p>
                  <p class="text-xs text-gray-500">Credit score</p>
                </div>
              </div>
              <div class="flex flex-col items-center gap-2 flex-1">
                <div class="indicator w-10 h-10 rounded-full flex items-center justify-center bg-gray-200 text-gray-500 font-semibold" data-step="4">4</div>
                <div class="text-center">
                  <p class="text-sm font-semibold text-gray-900">Loan Details</p>
                  <p class="text-xs text-gray-500">Amount & tenure</p>
                </div>
              </div>
            </div>

            <div data-slot="card" class="bg-white text-card-foreground flex flex-col gap-6 rounded-2xl shadow-lg border border-gray-100 p-8">
              <div id="steps" class="space-y-6">
                <!-- Step 1 -->
                <div class="step" data-step="1">
                  <h4 class="text-xl font-bold text-gray-900 mb-6 flex items-center gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-blue-600"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                    Personal Information
                  </h4>
                  <div class="space-y-5">
                    <div class="space-y-2">
                      <label for="name" class="text-sm font-semibold text-gray-900 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-600"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                        Full Name <span class="text-red-500">*</span>
                      </label>
                      <input id="name" class="w-full rounded-lg border border-gray-300 px-4 py-3 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition" placeholder="Enter your full name" required>
                      <p class="text-xs text-gray-500">As per your ID proof</p>
                    </div>
                    <div class="space-y-2">
                      <label for="pincode" class="text-sm font-semibold text-gray-900 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-600"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                        Area Pincode <span class="text-red-500">*</span>
                      </label>
                      <input id="pincode" maxlength="6" class="w-full rounded-lg border border-gray-300 px-4 py-3 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition" placeholder="6-digit pincode" required>
                      <p class="text-xs text-gray-500">We'll check bank availability in your area</p>
                    </div>
                    <div class="space-y-2">
                      <label for="category" class="text-sm font-semibold text-gray-900 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-600"><path d="M10 18v-7"></path><path d="M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z"></path><path d="M14 18v-7"></path><path d="M18 18v-7"></path><path d="M3 22h18"></path><path d="M6 18v-7"></path></svg>
                        Company Category <span class="text-red-500">*</span>
                      </label>
                      <select id="category" class="w-full rounded-lg border border-gray-300 px-4 py-3 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition cursor-pointer">
                        <option>Category A - MNC/Top Tier</option>
                        <option>Category B - Mid Market</option>
                        <option>Category C - SME</option>
                      </select>
                      <p class="text-xs text-gray-500">Helps us determine your eligibility</p>
                    </div>
                  </div>
                </div>

                <!-- Step 2 -->
                <div class="step hidden" data-step="2">
                  <h4 class="text-xl font-bold text-gray-900 mb-6 flex items-center gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-blue-600"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
                    Income & Obligations
                  </h4>
                  <div class="space-y-5">
                    <div class="space-y-2">
                      <label for="turnover" class="text-sm font-semibold text-gray-900 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-green-600"><path d="M12 2v20m10-10H2"></path></svg>
                        Monthly Salary <span class="text-red-500">*</span>
                      </label>
                      <input id="turnover" class="w-full rounded-lg border border-gray-300 px-4 py-3 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition" placeholder="Enter gross monthly salary in ₹">
                      <p class="text-xs text-gray-500">Your monthly take-home income</p>
                    </div>
                    <div class="space-y-2">
                      <label for="emis" class="text-sm font-semibold text-gray-900 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-orange-600"><path d="M12 2v20m10-10H2"></path></svg>
                        Monthly Obligations <span class="text-red-500">*</span>
                      </label>
                      <input id="emis" class="w-full rounded-lg border border-gray-300 px-4 py-3 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition" placeholder="Include EMIs, credit cards, etc.">
                      <p class="text-xs text-gray-500">All monthly loan & credit payments</p>
                    </div>

                    <div id="obligation-box" class="mt-6 rounded-lg bg-gradient-to-r from-blue-50 to-white p-4 border border-blue-100 flex justify-between items-center">
                      <div class="flex items-center gap-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-600"><path d="M12 2v20m10-10H2"></path></svg>
                        <div>
                          <div class="text-sm font-semibold text-gray-900">Obligation Ratio</div>
                          <p class="text-xs text-gray-500">Ideally ≤ 40%</p>
                        </div>
                      </div>
                      <div id="obligation-value" class="text-2xl font-bold text-blue-600">0.0%</div>
                    </div>
                  </div>
                </div>

                <!-- Step 3 -->
                <div class="step hidden" data-step="3">
                  <h4 class="text-xl font-bold text-gray-900 mb-6 flex items-center gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-blue-600"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 2.2"></path></svg>
                    Credit Profile
                  </h4>
                  <div class="space-y-5">
                    <div class="space-y-2">
                      <label for="cibil" class="text-sm font-semibold text-gray-900 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-purple-600"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 2.2"></path></svg>
                        CIBIL Score <span class="text-red-500">*</span>
                      </label>
                      <input id="cibil" class="w-full rounded-lg border border-gray-300 px-4 py-3 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition" placeholder="e.g., 750">
                      <p class="text-xs text-gray-500">Score range: 300-900 (Higher is better)</p>
                    </div>

                    <div id="credit-box" class="mt-6 rounded-lg bg-gradient-to-r from-green-50 to-white p-4 border border-green-100 flex justify-between items-center">
                      <div class="flex items-center gap-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-green-600"><path d="M21.801 10A10 10 0 1 1 17 3.335"></path><path d="m9 11 3 3L22 4"></path></svg>
                        <div>
                          <div class="text-sm font-semibold text-gray-900">Credit Rating</div>
                          <p class="text-xs text-gray-500">Your score category</p>
                        </div>
                      </div>
                      <div id="credit-rating" class="text-sm font-bold px-4 py-2 rounded-full bg-gray-100 text-gray-600">-</div>
                    </div>
                  </div>
                </div>

                <!-- Step 4 -->
                <div class="step hidden" data-step="4">
                  <h4 class="text-xl font-bold text-gray-900 mb-6 flex items-center gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-blue-600"><path d="M12 2v20"></path><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
                    Loan Details
                  </h4>
                  <div class="space-y-5">
                    <div class="space-y-2">
                      <label for="loan-amount" class="text-sm font-semibold text-gray-900 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-600"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v12m-4-3h8"></path></svg>
                        Loan Amount Required <span class="text-red-500">*</span>
                      </label>
                      <input id="loan-amount" class="w-full rounded-lg border border-gray-300 px-4 py-3 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition" placeholder="Enter amount in ₹">
                      <p class="text-xs text-gray-500">Amount you wish to borrow</p>
                    </div>
                    <div class="space-y-2">
                      <label for="tenure" class="text-sm font-semibold text-gray-900 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-600"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                        Loan Tenure <span class="text-red-500">*</span>
                      </label>
                      <select id="tenure" class="w-full rounded-lg border border-gray-300 px-4 py-3 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition cursor-pointer">
                        <option value="240">20 years (240 months)</option>
                        <option value="120">10 years (120 months)</option>
                        <option value="60">5 years (60 months)</option>
                      </select>
                      <p class="text-xs text-gray-500">Repayment period</p>
                    </div>

                    <div class="mt-6 rounded-lg bg-gradient-to-r from-blue-50 via-purple-50 to-blue-50 p-5 border border-gray-200">
                      <div class="text-sm font-bold text-gray-900 mb-4 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-600"><path d="M12 2v20m-7-7h14"></path></svg>
                        Application Summary
                      </div>
                      <div class="grid grid-cols-2 gap-3 text-sm">
                        <div class="text-gray-600">Full Name</div><div id="sum-name" class="text-right font-semibold text-gray-900">-</div>
                        <div class="text-gray-600">CIBIL Score</div><div id="sum-cibil" class="text-right font-semibold text-gray-900">-</div>
                        <div class="text-gray-600">Monthly Salary</div><div id="sum-salary" class="text-right font-semibold text-gray-900">-</div>
                        <div class="text-gray-600">Loan Amount</div><div id="sum-loan" class="text-right font-semibold text-gray-900">-</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="pt-6 border-t flex justify-between gap-4">
                <button id="btn-back" class="inline-flex items-center gap-2 rounded-lg border border-gray-300 px-6 py-3 font-medium text-gray-700 hover:bg-gray-50 transition" disabled>
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="m15 18-6-6 6-6"></path></svg>
                  Back
                </button>
                <button id="btn-next" class="inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-semibold transition shadow-md hover:shadow-lg border border-blue-700">Next
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="m9 18 6-6-6-6"></path></svg>
                </button>
              </div>
            </div>
          </div>
        </div>
    </main>

    <!-- FEATURES SECTION -->
    <div class="bg-gray-50 border-t border-gray-200 py-12 mt-12">
      <div class="max-w-5xl mx-auto px-4">
        <div class="flex flex-wrap justify-center gap-8 md:gap-12">
          <div class="flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5 text-green-600"><path d="M21.801 10A10 10 0 1 1 17 3.335"></path><path d="m9 11 3 3L22 4"></path></svg>
            <span class="text-sm text-gray-700 font-medium">Real-time eligibility check</span>
          </div>
          <div class="flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5 text-blue-600"><path d="M12 2v20m10-10H2"></path></svg>
            <span class="text-sm text-gray-700 font-medium">Compare 50+ banks</span>
          </div>
          <div class="flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5 text-amber-600"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 2.2"></path></svg>
            <span class="text-sm text-gray-700 font-medium">Instant results</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Result Modal -->
    <div id="result-modal" class="fixed inset-0 hidden items-center justify-center z-50">
      <div class="absolute inset-0 bg-black/50"></div>
      <div class="bg-white rounded-lg shadow-lg p-6 z-10 max-w-lg w-full">
        <h3 id="modal-title" class="text-lg font-semibold mb-2">Eligibility Result</h3>
        <div id="modal-body" class="mb-4 text-sm text-gray-700">Processing...</div>
        <div class="flex justify-end gap-2">
          <button id="modal-close" class="px-4 py-2 border rounded">Close</button>
          <a id="modal-offers" href="/LiveOffers" class="px-4 py-2 bg-blue-600 text-white rounded">View Offers</a>
        </div>
      </div>
    </div>

    <script>
      (function(){
        var current = 1;
        var total = 4;
        var steps = document.querySelectorAll('#steps .step');
        var indicators = document.querySelectorAll('.indicator');
        var progressFill = document.getElementById('progress-fill');
        var btnNext = document.getElementById('btn-next');
        var btnBack = document.getElementById('btn-back');

        var inpName = document.getElementById('name');
        var inpPincode = document.getElementById('pincode');
        var inpCategory = document.getElementById('category');
        var inpSalary = document.getElementById('turnover');
        var inpOblig = document.getElementById('emis');
        var inpCibil = document.getElementById('cibil');
        var inpLoan = document.getElementById('loan-amount');
        var inpTenure = document.getElementById('tenure');

        var obligationValue = document.getElementById('obligation-value');
        var creditRating = document.getElementById('credit-rating');

        var sumName = document.getElementById('sum-name');
        var sumCibil = document.getElementById('sum-cibil');
        var sumSalary = document.getElementById('sum-salary');
        var sumLoan = document.getElementById('sum-loan');

        var modal = document.getElementById('result-modal');
        var modalTitle = document.getElementById('modal-title');
        var modalBody = document.getElementById('modal-body');
        var modalClose = document.getElementById('modal-close');
        var modalOffers = document.getElementById('modal-offers');

        function fmtINR(v){
          if(!v) return '-';
          var num = Number(String(v).replace(/[^0-9.-]+/g, '')) || 0;
          return new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', maximumFractionDigits:0 }).format(num);
        }

        function updateIndicators(n){
          indicators.forEach(function(ind, idx){
            var stepIndex = idx+1;
            if(stepIndex < n){
              ind.className = 'indicator w-10 h-10 rounded-full flex items-center justify-center bg-blue-600 text-white';
              ind.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M20 6L9 17l-5-5"></path></svg>';
            } else if(stepIndex === n){
              ind.className = 'indicator w-10 h-10 rounded-full flex items-center justify-center bg-blue-600 text-white';
              ind.textContent = String(stepIndex);
            } else {
              ind.className = 'indicator w-10 h-10 rounded-full flex items-center justify-center bg-gray-200 text-gray-500';
              ind.textContent = String(stepIndex);
            }
          });
        }

        function updateProgress(n){
          var pct = Math.round(((n-1)/(total-1))*100);
          progressFill.style.width = pct + '%';
        }

        function showStep(n){
          steps.forEach(function(s){ s.classList.add('hidden'); });
          var el = document.querySelector('#steps .step[data-step="'+n+'"]');
          if(el) el.classList.remove('hidden');
          updateIndicators(n);
          updateProgress(n);
          btnBack.disabled = (n===1);
          btnNext.textContent = (n===total) ? 'Check Eligibility' : 'Next';
        }

        function validateStep(n){
          if(n===1){
            if(!inpName.value.trim()){ alert('Please enter full name'); inpName.focus(); return false; }
            if(!/^[0-9]{6}$/.test(inpPincode.value.trim())){ alert('Please enter valid 6-digit pincode'); inpPincode.focus(); return false; }
          }
          if(n===2){
            var s = Number(String(inpSalary.value).replace(/[^0-9.-]+/g,'')) || 0;
            if(s<=0){ alert('Please enter your monthly salary'); inpSalary.focus(); return false; }
          }
          return true;
        }

        function updateObligation(){
          var s = Number(String(inpSalary.value).replace(/[^0-9.-]+/g,'')) || 0;
          var o = Number(String(inpOblig.value).replace(/[^0-9.-]+/g,'')) || 0;
          var pct = s>0 ? (o/s*100) : 0;
          obligationValue.textContent = pct ? pct.toFixed(1) + '%' : '0.0%';
        }

        function updateCredit(){
          var c = Number(String(inpCibil.value).replace(/[^0-9.-]+/g,'')) || 0;
          var label = '-';
          var color = 'text-gray-700';
          if(c>=750){ label = 'Excellent'; color = 'text-green-700'; }
          else if(c>=700){ label = 'Good'; color = 'text-yellow-700'; }
          else if(c>=650){ label = 'Fair'; color = 'text-orange-700'; }
          else if(c>0){ label = 'Poor'; color = 'text-red-700'; }
          creditRating.textContent = label;
          creditRating.className = 'text-sm font-semibold px-3 py-1 rounded-full ' + color;
        }

        function updateSummary(){
          sumName.textContent = inpName.value || '-';
          sumCibil.textContent = inpCibil.value || '-';
          sumSalary.textContent = fmtINR(inpSalary.value);
          sumLoan.textContent = fmtINR(inpLoan.value);
        }

        // Eligibility evaluation (stricter, more realistic rule)
        function calcEMI(P, annualPercent, nMonths){
          var r = (annualPercent/100)/12;
          if(nMonths<=0) return 0;
          if(r===0) return Math.round(P/nMonths);
          var x = Math.pow(1+r, nMonths);
          var emi = P * r * x / (x-1);
          return Math.round(emi);
        }

        function evaluateEligibility(){
          var salary = Number(String(inpSalary.value).replace(/[^0-9.-]+/g,'')) || 0;
          var oblig = Number(String(inpOblig.value).replace(/[^0-9.-]+/g,'')) || 0;
          var cibil = Number(String(inpCibil.value).replace(/[^0-9.-]+/g,'')) || 0;
          var requested = Number(String(inpLoan.value).replace(/[^0-9.-]+/g,'')) || 0;
          var tenure = Number(inpTenure.value) || 240;

          var obligationRatio = salary>0 ? (oblig/salary) : 1;
          var reasons = [];

          // stricter thresholds
          if(salary < 15000) reasons.push('Monthly salary below minimum threshold (₹15,000)');
          if(obligationRatio > 0.4) reasons.push('High obligation ratio (' + (obligationRatio*100).toFixed(1) + '%) — ideally <= 40%');
          if(cibil > 0 && cibil < 700) reasons.push('CIBIL score below 700');

          // compute risk-based multiplier by credit tier
          var tierMultiplier = 0;
          if(cibil >= 750) tierMultiplier = 30;
          else if(cibil >= 700) tierMultiplier = 25;
          else if(cibil >= 650) tierMultiplier = 20;
          else tierMultiplier = 12;

          var maxAllowed = Math.round(salary * tierMultiplier * (1 - obligationRatio));
          // absolute caps
          var ABS_CAP = 50000000;
          if(maxAllowed > ABS_CAP) maxAllowed = ABS_CAP;

          if(requested > 0 && requested > maxAllowed) reasons.push('Requested amount exceeds suggested limit of ' + fmtINR(maxAllowed));

          var eligible = reasons.length===0 && salary>=15000 && cibil>=700 && obligationRatio <= 0.4;

          // compute sample EMI for requested and suggested amounts using a conservative rate based on cibil
          var baseRate = (cibil>=750) ? 9.0 : (cibil>=700) ? 10.5 : (cibil>=650) ? 12.5 : 14.5;
          var requestedEMI = requested>0 ? calcEMI(requested, baseRate, tenure) : null;
          var suggestedEMI = maxAllowed>0 ? calcEMI(maxAllowed, baseRate, tenure) : null;

          return {
            eligible: eligible,
            reasons: reasons,
            obligationRatio: obligationRatio,
            maxAllowed: maxAllowed,
            cibil: cibil,
            requestedEMI: requestedEMI,
            suggestedEMI: suggestedEMI,
            baseRate: baseRate,
            tenure: tenure
          };
        }

        function showModal(result){
          modalTitle.textContent = result.eligible ? 'Eligible' : 'Not Eligible';
          var html = '';
          html += '<p class="mb-2">Obligation Ratio: <strong>' + (result.obligationRatio*100).toFixed(1) + '%</strong></p>';
          html += '<p class="mb-2">CIBIL: <strong>' + (result.cibil || '-') + '</strong></p>';
          html += '<p class="mb-2">Estimated interest rate used: <strong>' + result.baseRate.toFixed(2) + '%</strong></p>';
          html += '<p class="mb-3">Suggested maximum loan amount: <strong>' + (result.maxAllowed>0 ? fmtINR(result.maxAllowed) : '-') + '</strong></p>';
          if(result.requestedEMI !== null) html += '<p class="mb-2">Requested EMI estimate: <strong>' + fmtINR(result.requestedEMI) + '/mo</strong> (' + result.tenure + ' months)</p>';
          if(result.suggestedEMI !== null) html += '<p class="mb-4">Suggested EMI estimate: <strong>' + fmtINR(result.suggestedEMI) + '/mo</strong></p>';

          if(result.reasons && result.reasons.length){
            html += '<div class="text-sm text-red-700 mb-3"><strong>Reasons:</strong><ul class="pl-5 mt-1">';
            result.reasons.forEach(function(r){ html += '<li>' + r + '</li>'; });
            html += '</ul></div>';
          } else {
            html += '<div class="text-sm text-green-700 mb-3">You meet the basic criteria. Below are tailored offers from partner lenders.</div>';
          }

          html += '<div id="offers-list" class="space-y-3">Loading offers ...</div>';

          modalBody.innerHTML = html;
          modalOffers.href = 'LiveOffers.html?eligible=' + (result.eligible ? '1' : '0') + '&max=' + (result.maxAllowed || 0) + '&cibil=' + (result.cibil || 0);
          modal.classList.remove('hidden');
          modal.classList.add('flex');

          // fetch mock offers and display best matches
          fetch('mock-api/offers.json').then(function(r){ return r.json(); }).then(function(list){
            var userCibil = result.cibil || 0;
            var salary = Number(String(inpSalary.value).replace(/[^0-9.-]+/g,'')) || 0;
            var max = result.maxAllowed || 0;
            var matches = list.filter(function(o){ return userCibil >= o.minCibil && salary >= o.minSalary && max > 0; });
            // sort by interestRate ascending
            matches.sort(function(a,b){ return a.interestRate - b.interestRate; });
            var out = '';
            if(matches.length===0){ out = '<div class="text-sm text-gray-600">No matching offers found for your profile. Try reducing requested amount or improving credit score.</div>'; }
            else {
              matches.slice(0,5).forEach(function(o){
                var emiForMax = calcEMI(max, o.interestRate, result.tenure);
                out += '<div class="p-3 border rounded flex justify-between items-center">';
                out += '<div><div class="font-medium">' + o.bank + '</div><div class="text-xs text-gray-500">Interest: ' + o.interestRate.toFixed(2) + '%</div></div>';
                out += '<div class="text-right"><div class="text-sm">Max loan: <strong>' + fmtINR(max) + '</strong></div><div class="text-sm">Est. EMI: <strong>' + fmtINR(emiForMax) + '/mo</strong></div></div>';
                out += '</div>';
              });
            }
            var container = document.getElementById('offers-list');
            if(container) container.innerHTML = out;
          }).catch(function(){
            var container = document.getElementById('offers-list');
            if(container) container.innerHTML = '<div class="text-sm text-red-600">Unable to load offers at this time.</div>';
          });
        }

        modalClose.addEventListener('click', function(){ modal.classList.add('hidden'); modal.classList.remove('flex'); });

        // live updates
        inpOblig.addEventListener('input', updateObligation);
        inpSalary.addEventListener('input', function(){ updateObligation(); updateSummary(); });
        inpCibil.addEventListener('input', updateCredit);
        inpName.addEventListener('input', updateSummary);
        inpLoan.addEventListener('input', updateSummary);
        inpTenure.addEventListener('change', updateSummary);

        btnNext.addEventListener('click', function(){
          if(current < total){
            if(!validateStep(current)) return;
            current++;
            showStep(current);
          } else {
            // final submit: evaluate eligibility and show modal
            updateSummary();
            var result = evaluateEligibility();
            showModal(result);
          }
        });

        btnBack.addEventListener('click', function(){ if(current>1){ current--; showStep(current); } });

        // initialize
        updateObligation(); updateCredit(); updateSummary();
        showStep(current);
      })();
    </script>
    </main>

      <div id="site-footer"></div>
    </div>
    <script src="assets/include-header-footer.js"></script>
  </body>
</html>